<!--
title:   React 18のuseIdでアクセシビリティ向上（WAI-ARIAのRelationship attributes）
tags:    QiitaEngineerFesta_React18,React,WAI-ARIA,accessibility,アクセシビリティ
-->

## この記事の概要

React 18で新しく[useIdというhooks](https://ja.reactjs.org/docs/hooks-reference.html#useid)が使えるようになりました。
コンポーネントにWAI-ARIAを導入するにあたって、便利になると思ったのでいくつかのパターンを紹介します。

また、Qiita Engineer Festa 2022の「React 18、あなたならどう使いこなす？」への投稿記事でもあります。

https://qiita.com/official-events/6677e0827fec55a3b95f

## useid以前

実例を紹介する前に、なぜこの記事を書こうと思ったかについて説明します。

例えば`aria-labelledby`を使う場合、以下のようになります。
（コードは[MDN Docsのaria-labelledbyのページ](https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-labelledby)より拝借）

```html
<span role="checkbox" aria-checked="false" tabindex="0" aria-labelledby="tac"></span>
<span id="tac">I agree to the Terms and Conditions.</span>
```

簡単に説明すると、まず`role="checkbox"`のspanは`aria-labelledby="tac"`の記述によって`id="tac"`のspanを参照しています。
そのため`role="checkbox"`のspanにフォーカスを当てると`I agree to the Terms and Conditions.`と読み上げられます。

`aria-labelledby`が無かった場合、見た目としては紐付いていてもスクリーンリーダーはそれを検知できません。
マシンからしたら、謎のチェックボックスがぽつんと置いてある感じ……とでも言えるのでしょうか。

`aria-labelledby`も含めて、この後紹介する属性はすべて他要素のidを参照して読み上げなどを支援します。

ここで、idを使用するため若干の難しさが生まれます。
コンポーネントを作るにあたって、どの場所で何回使われるか？というのは考慮に入れるものではありません。
しかしidは1ページで1つしか使ってはいけないので、単に固定した文字列を指定すると重複してしまう可能性があります。

回避するためには、propsとして毎回idを指定するか[nanoid](https://github.com/ai/nanoid)などのライブラリで生成するか、あたりが選択肢になると思います。
前者は結局人間が指定するのでうっかり重複してしまうかもしれませんし、後者は（気持ちの問題ですが）このために依存関係を増やすのは……となっていました。
